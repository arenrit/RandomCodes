%let AccQtr = AYrQtr in
        (
        '2012Q1','2012Q2','2012Q3','2012Q4',
           '2013Q1','2013Q2','2013Q3','2013Q4',
           '2014Q1','2014Q2','2014Q3','2014Q4',
        '2015Q1','2015Q2','2015Q3','2015Q4');

data 
  emblem_freq_dam_final_1(drop = rn)
  emblem_freq_dam_final_2(drop = rn)
  emblem_freq_dam_final_3(drop = rn)
  emblem_freq_dam_final_4(drop = rn)
  emblem_freq_dam_final_5(drop = rn)
  emblem_freq_dam_final_6(drop = rn)
  emblem_freq_dam_final_7(drop = rn)
  emblem_freq_dam_final_8(drop = rn)
  emblem_freq_dam_final_9(drop = rn)
  emblem_freq_dam_final_0(drop = rn);
  set test.emblem_freq_dam_final_1(keep = 
AYrQtr
RandNum
Data_Source
Product_Group
Master_Group
RandNum6_1
RandNum6_2
Ay_RandNum
Comb_RF_Injury
Comb_RF_NonInjury
Driving_Entitlement
Number_of_Drivers
Age_of_Policy
Cal_Age_of_Policy
NCD_Years
NCD_Protected
Voluntary_Excess
Total_Excess_Amount
Class_of_Use
Total_Driver_Number_DS
MTA_Current
MTA_prior
vehicle_brand
Vehicle_Age
Vehicle_DSP
Vehicle_Value
Annual_Mileage
vehicle_engine_cc
vehicle_fuel_new
Vehicle_Transmission
pli_doors
Vehicle_Parking_Type
Vehicle_Security_System
vehicle_security
vehicle_segment
AXACarGroup
Vehicle_Class_new
AXACarMakeId
vehicle_group_new
pli_power
pli_vehicle_bodytype
vehicleco2emissionsabi
pli_length
pli_speed
pli_power_to_weight
VehicleRacerIndexABI
aeb_test_score
aspiration_type
cam_configuration
cylinder_configuration
front_bumper_cover_price
front_panel_price
gr50_model
gr50_grp
gr50_security
inspection_hours_front
number_of_cylinders
number_of_valves
power_output
primary_fuel_type
vehicleaccelerationabi
vehiclecombinedmpgabi
vehiclewidthabi
windscreen_price
Cluster_Vehicle
AD_FREQ_NEW
TPD_FREQ_NEW
TPPI_P_FREQ_NEW
WS_FREQ_NEW
TH_FREQ_NEW_NSC
ad_sev_new
tpd_sev_new
th_sev_new
th_sev_new_nsc
tppi_cpc_new_nsc
Final_B_Vehicle_Rating_AD1
Final_B_Vehicle_Rating_FTMD1
Final_B_Vehicle_Rating_TPD1
Final_B_Vehicle_Rating_TPI1
Final_B_Vehicle_Rating_WS1
Worst_Licence_Years_Cal
Worst_Licence_Type
All_ClmCount
Add_ClaimCount
All_ConvType_7_8
WorstConvCount
ConvCount
All_ConvType_9_11Grp3
Maximum_Demerit_Score_1
Total_Demerit_Score_1
Average_Demerit_Score_1_All_Drv
MainDr_Demerit_Score_1
HRDr_Demerit_Score_1
Maximum_Demerit_Score_2
Total_Demerit_Score_2
Average_Demerit_Score_2_All_Drv
MainDr_Demerit_Score_2
HRDr_Demerit_Score_2
Maximum_Age
Minimum_Age
Mean_Age
Dist_Age_Max_Min
Dist_Age_Max_MD
Dist_Age_Max_HRD
Dist_Age_Min_MD
Dist_Age_Min_HRD
Dist_Age_Sum_Avg
Dist_Age_Sum_MD
Dist_Age_Sum_HRD
DD_Main_HRD_Age
MainDr
MainDr_Age_Cal
MainDr_Age_Half_Years
MainDr_Age_Quarter_Years
MainDr_Licence_Years_Cal
MainDr_Licence_Months
MainDr_Licence_Type
MainDr_Marital
MainDr_Occ_Group
MainDr_ClmCount
MainDr_WorstClmType
MainDr_Months_Last_Claim_Cal
MainDr_ConvCount
MainDr_ConvType7_8
MainDr_Months_Last_Conv_Cal
HRDr
HRDr_Age_Cal
HRDr_Age_Half_Years
HRDr_Age_Quarter_Years
HRDr_Licence_Years_Cal
HRDr_Licence_Months
HRDr_Licence_Type
HRDr_Marital
HRDr_Occ_Group
HRDr_ClmCount
HRDr_WorstClmType
HRDr_Months_Last_Claim_Cal
HRDr_ConvCount
HRDr_ConvType7_8
HRDr_Months_Last_Conv_Cal
ID_APPL_GC
ID_Score_Damage_Frequency
ID_Score_Injury_Frequency
ID_Score_Comb_ex_Geo
GEORISK2006_CCJ_ITB
GEORISK2006_GD1_SUB
GEORISK2006_FAMILY_XTB
CurrentPLIRatedArea
CurrentDirInjRatedArea
CurrentDirNinjRatedArea
Cluster_Area
TH_Cluster_CLI
FI_Cluster_CLI
HH_EMB_TH_12
HH_EMB_BLD_FI_12
HH_EMB_BLD_TH_12
HH_EMB_CNT_FI_12
HH_EMB_CNT_THF_12
WS_SMOOTHRES_CLUSTER
AddressLinksWarning
GoneAwayWarning
MatchLevel
AppVerified
ERValid
ERLORWarning
PAFValid
ShareRecords
ShareRecordsUsed
UKInvestorsRecords
UKInvestorsRecordsUsed
NumBais
NumBaisused
NumCCJs
NumCCJsUsed
GeoFraudIndexCurrent
Vehicle_DSP_x_Vehicle_Age
DriverWrstCount_x_WrstType
HRDrCount_x_WrstType
HRDr_Age_x_Old_CS
HRDr_Age_x_Combine_Score
NCD_x_PNCD_x_ClaimCount
HRDr_Age_x_Mileage
VehiclePowerToSpeedRatio
VehiclePowerToLengthRatio
Veh_Age_PD
Veh_Age_Half_Years_PD
Veh_Age_Quarter_Years_PD
POL_O_NO_500
POL_O_YES_1000
FIRPOI_FRON_3000
FIRPOI_NEAR_1000
FIRPOI_OFFS_500
J_C_AUTOTRA_1000
J_L_ENTFRO_3000
NUM_OF_ACCI_3000
ROAD_A_500
ROAD_B_500
ROAD_C_500
ROAD_T_DUAL_1000
ROAD_T_SING_3000
V_L_ONMAINC_3000
BD_AREA1504_ALARM_SYSTEMS_KM
BD_AREA1504_BUS_OPERATORS_KM
BD_AREA1504_CAR_BODY_REPAIR_KM
BD_AREA1504_GARAGE_KM
BD_AREA1504_PUBLIC_HOUSES_KM
BD_AREA1504_SECURITY_SERVICES_KM
BD_SECT1504_ALCOHOL_RETAIL_HH
BD_SECT1504_CONVENIENCE_STORE_KM
BD_SECT1504_CHIPPY_KM
BD_SECT1504_PUBLIC_HOUSES_HH
BD_SECT1504_PUBLIC_HOUSES_KM
BD_SECT1504_SECURITY_SERVICES_KM
BD_SECT1504_TAKE_AWAY_KM
CACI1506_ACORNG06
CACI1506_ACORNC
CACI1506_ACORNG
CACI1506_ACORN
CACI1506_FINACORNG
CACI1506_FINACORN
CACI1506_LUKP_A2_AGE2
CACI1506_LUKP_CAR1BTNEW
CACI1506_LUKP_CAR1BTUSED
CACI1506_HHDATTRIB_095
CACI1506_IPS_FACEBOOK
CACI1506_IPS_IPHONE
CACI1506_IPS_VOUCHERS
CACI1506_FR_SAV_ACC
CACI1506_FR_INS_CONT
CACI1506_LUKP_HOUSEAGE3
CACI1506_LUKP_HOUSEAGE4
CACI1506_LUKP_HOUSEAGE5
CACI1506_LUKP_HOUSEAGE6
CACI1506_LUKP_HOUSEAGE7
CACI1506_LUKP_MORTGAGE
CACI1506_LUKP_INTERESTS18
CACI1506_LUKP_OCCD11
CACI1506_LUKP_A2_HOUSE1
CACI1506_LUKP_SMOKER
CACI1506_LUKP_SUNDAY3
CACI1506_LUKP_A2_HOUSE8
CACI1506_PCHECK_MEAN
CACI1506_PCHECK_MEDIAN
CACI1506_PCHECK_MODE
CACI1506_PCHECK_STDDEV
CACI1506_LIFESTAGE
CACI1506_SVALUE_MEAN
CEN111504_A2_CARS_OR_VANS_IN_HH
CEN111504_A4_ADMIN_SECRETARIAL
CEN111504_A5_SKILLEDTRADESOCCU
CEN111504_A7_ROUTINE_OCCU
CEN111504_A8_NEVER_WRKD_LT_UNE
CEN111504_A8_PLANTMACHINEOPERAT
CEN111504_AAREA_HECTARES
CEN111504_AB_MINING_QUARRYING
CEN111504_ADENSITY_PPH
CEN111504_AECNMINACTV_RETIRED
CEN111504_AH_TRANSPORT_STORAGE
CEN111504_AHIGH_QUAL_LVL_1_QUAL
CEN111504_AI_ACCOMANDFOOD_SERV
CEN111504_AK_FINANINSUR
CEN111504_AL142_LT_UNEMP
CEN111504_ALIVE_IN_A_HH
CEN111504_AM_SCIENTIFIC
CEN111504_AMEDIAN_AGE
CEN111504_ANO_CARS_OR_VANS_IN_HH
CEN111504_A1F_MRRD_CP_NCHLD
CEN111504_AUNEMP_NEVER_WRKD
CEN111504_AWHL_HOUSEBUNG_DTCHD
CEN111504_AWHL_HOUSEBUNGTERR
EGUSAGE1612_13NB_GAS_METERS
EXPERIAN1510_THEFTRS
EXPERIAN1510_WI50RI
FPA1504_IMM_8_TO_6_10_OUT_HH
FPA1504_IMM_9_TO_5_20_HH
FPA1504_APP_8_TO_6_30_OUT_HH
FPA1504_APP_9_TO_5_30_HH
FPA1504_APP_9_TO_5_10_OUT
FPA1504_APP_9_TO_5_20
FPA1504_APP_9_TO_5_30_OUT
FSS1511_2005_GROUP
FSS1511_2005_TYPE
FSS1511_2011_GROUP
FSS1511_2011_TYPE
MET1504_AVGMAXTEMP30YRS
MET1504_AVGMINTEMP30YRS
MET1504_AVGRAINMONTHLYMM30YRS
MET1504_AVGSUNMONTHLYHOURS30YRS
MET1504_AVGAIRFROSTDAYS30YRS
MOSAIC1511_2014_GROUP
MOSAIC1511_2014_SEGMENT
MOSAIC1511_2014_TYPE
NORM1504_CAR_VAN_COUNTS
ONS1504_AVE_AGE
ONS1504_AVE_DIST_TO_WORK
ONS1504_AVG_HH_ROOMS
ONS1504_CAR_DENSITY
ONS1504_MOST_COMMON_PROPERTY
ONS1504_KS20_MARRIED_COUPLE_PCT
ONS1504_KS21_CHILDREN_HH_PCT
ONS1504_CHILDREN_UNDER_4_PCT
ONS1504_LOW_FLR_FIFTH_PCT
ONS1504_LOW_FLR_FIRST_PCT
ONS1504_CLAIMANTS_2007_PCT
ONS1504_MANUFACTURING_PCT
ONS1504_WHLSALE_RETAIL_TRADE_PCT
ONS1504_LEVEL_4_PLUS_QUAL_PCT
ONS1504_SEMIDETACHED_PCT
ONS1504_KS21_UNEMPLOYED_PCT
ONS_GIS1504_MOTJUN_DIST
ONS_GIS1504_POL_DISTANCE
OSGEO_PC1504_DIST_TO_STADIUMS
OSGEO_PC1504_DIST_TO_CAMPUS
OSGEO_PC1504_DIST_TO_JUN
OSGEO_PC1504_DIST_TO_RD_END
OSGEO_PC1504_SETTLMNT_TYPE
OSGEO_PC1504_URB_REG
PERSONIX1504_PSNCXINC
personix1504_psncxgeo_num
POL_NP1504_ANTI_OBS_SOC_FREQ
POL_NP1504_VIOL_SMOOTHING_3_30_
POLICEUK1504_ANTI_10_OWN_SCT_2_4
POLICEUK1504_ANTI_5_VEH_SCT_2_6
POLICEUK1504_ANTI_5_HH_SCT_6_9
POLICEUK1504_BICY_20_VEH_SCT_2_6
POLICEUK1504_BICY_20_OWN_SCT_2_4
POLICEUK1504_BURG_20_VEH_SCT_2_6
POLICEUK1504_BURG_5_OWN_SCT_2_4
POLICEUK1504_CRIM_10_HH_SCT_2_4
POLICEUK1504_CRIM_5_OWN_SCT_2_4
POLICEUK1504_DRUG_5_HH_SCT_2_4
POLICEUK1504_PUBL_20_HH_SCT_2_4
POLICEUK1504_ROBB_5_OWN_SCT_2_4
POLICEUK1504_SHOP_5_OWN_SCT_2_4
POLICEUK1504_VEHI_10_OWN_SCT_2_4
POLICEUK1504_VEHI_20_HH_SCT_2_4
POLICEUK1504_VEHI_50_OWN_SCT_2_4
POLICEUK1504_VEHI_5_OWN_SCT_2_4
POLICEUK1504_VIOL_10_OWN_SCT_2_4
POLICEUK1504_VIOL_50_OWN_SCT_2_4
POLICEUK1504_VIOL_5_OWN_SCT_2_4
A
C
E
N
O
RICS1504_REGION
SCHOOLS1510_DIST_TO_SEC_SCHOOL
SCHOOLS1510_DISTANCE_TO_SCHOOL
SCHOOLS1510_DIST_TO_PRIM_SCHOOL
SOCIODEM1504_SOCIODEM_CATEGORY
SUPERPRO1504_CLUSTER_CODE
SUPERPRO1504_LIFESTYLE_CODE
SUPERPRO1504_TARGET_CODE
TRAF_DEN1602_TRAF_10_ALL_12
TRAF_DEN1602_TRAF_10_ALL_14
TRAF_DEN1602_TRAF_30_ALL_14
TRAF_DEN1602_TRAF_5_ALL_14
TRAF_DEN1602_TRAF_10_CAR_14
TRAF_DEN1602_TRAF_30_CAR_14
TRAF_DEN1602_TRAF_5_CAR_14
TRAF_DEN1602_ROAD_LENGTH_1000M
TRAF_DEN1602_ROAD_LENGTH_3000M
TRAF_DEN1602_ROAD_LENGTH_500M
TRAF_DEN1602_ROAD_WITIN_1000M
BAND
Factor1
Factor2
Factor3
Factor4
Factor5 
where=(&AccQtr. and Master_Group not in ('G1936') 
and MainDr_Age ne . and ind1day = 0 and VehicleRacerIndexABI ^= 4 
and Voluntary_Excess < 500 and Annual_Mileage <= 20000 and Vehicle_Value <= 50000 and 
NumCCJs < 1 and ID_APPL_GC in ('I1') and vehicle_brand not in ('PORSCHE')));
  rn = ranuni(17051987);
       if rn <= then output emblem_freq_dam_final_1;
  else if rn <= then output emblem_freq_dam_final_2;
  else if rn <= then output emblem_freq_dam_final_3;
  else if rn <= then output emblem_freq_dam_final_4;
  else if rn <= then output emblem_freq_dam_final_5;
  else if rn <= then output emblem_freq_dam_final_6;
  else if rn <= then output emblem_freq_dam_final_7;
  else if rn <= then output emblem_freq_dam_final_8;
  else if rn <= then output emblem_freq_dam_final_9;
  else               output emblem_freq_dam_final_0;
run;

proc export data = emblem_freq_dam_final_1 outfile = "D:\work\01. Motor Risk Pricing\WS\WS1.csv" dbms=csv replace; run;
proc export data = emblem_freq_dam_final_2 outfile = "D:\work\01. Motor Risk Pricing\WS\WS2.csv" dbms=csv replace; run;
proc export data = emblem_freq_dam_final_3 outfile = "D:\work\01. Motor Risk Pricing\WS\WS3.csv" dbms=csv replace; run;
proc export data = emblem_freq_dam_final_4 outfile = "D:\work\01. Motor Risk Pricing\WS\WS4.csv" dbms=csv replace; run;
proc export data = emblem_freq_dam_final_5 outfile = "D:\work\01. Motor Risk Pricing\WS\WS5.csv" dbms=csv replace; run;
proc export data = emblem_freq_dam_final_6 outfile = "D:\work\01. Motor Risk Pricing\WS\WS6.csv" dbms=csv replace; run;
proc export data = emblem_freq_dam_final_7 outfile = "D:\work\01. Motor Risk Pricing\WS\WS7.csv" dbms=csv replace; run;
proc export data = emblem_freq_dam_final_8 outfile = "D:\work\01. Motor Risk Pricing\WS\WS8.csv" dbms=csv replace; run;
proc export data = emblem_freq_dam_final_9 outfile = "D:\work\01. Motor Risk Pricing\WS\WS9.csv" dbms=csv replace; run;
proc export data = emblem_freq_dam_final_0 outfile = "D:\work\01. Motor Risk Pricing\WS\WS0.csv" dbms=csv replace; run;
